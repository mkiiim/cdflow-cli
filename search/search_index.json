{"config":{"indexing":"full","lang":["en"],"min_search_length":3,"prebuild_index":false,"separator":"[\\s\\-]+"},"docs":[{"location":"","text":"C\u00e6study DonationFlow CLI DonationFlow CLI is a command-line tool for importing donation data from external sources like CanadaHelps and PayPal into your NationBuilder account. It is designed to be a bridge for organizations that use payment processors not natively integrated with NationBuilder, or for those migrating from other CRM platforms. DonationFlow CLI is extensible to other payment processor sources through an existing adapter template and a plugin architecture through which organization-specific business rules can be implemented. DonationFlow CLI was originally developed to help a non-profit charitable organization successfully migrate their donation data from CiviCRM and integrate their existing PayPal and CanadaHelps workflows with NationBuilder. Key Features Import from External Sources: Import donation data from CanadaHelps and PayPal CSV exports. Extensible Design: The tool is designed to be adaptable to other payment platform sources, includes a generic adapter, and is extensible with plugins. Detailed Logging: Comprehensive logging of every import job operation, for easy troubleshooting. Auditing: Job files provide detailed audit trail for each imported donation record. Rollback Capable: A separate command allows you to safely rollback donation import jobs (deleting the imported transaction(s) from NationBuilder) if needed. Prerequisites Python 3.8+ A NationBuilder account with API access. A configured NationBuilder OAuth application. Donation data exported as CSV files from CanadaHelps or PayPal. Installation Create an environment and activate python3 -m venv <my-environment-name> source <my-environment-name>/bin/activate Install using PIP pip install cdflow-cli For development installation, please see the Contribution Guide . Quick Start Initialize configuration: Run cdflow init to create template files: ~/.config/cdflow/local.yaml - Main configuration file (default location) ~/.env/nb_local.env - OAuth environment variables template (non-configurable location) Configure OAuth credentials: Edit ~/.env/nb_local.env with your NationBuilder OAuth credentials, then load: Locate the load-secrets.sh script If you have installed via pip and have created your virtual environment: cd <path-to-venv-environment-directory>/lib/python3.13/site-packages/cdflow_cli/scripts/ Execute the script using your .env file as the parameter source ./load-secrets.sh ~/.env/nb_local.env Update the import configuration: In your configuration file (e.g., local.yaml ), update the cli_import section to point to your CSV file(s). Place your CSV file: Put your CanadaHelps or PayPal CSV file in the cli_source directory you specified in your configuration. Run the import: cdflow import --config /path/to/your/local.yaml Or with less verbose output cdflow import --config /path/to/your/local.yaml --log-level NOTICE Alternative: Override import settings via CLI flags You can override the import type and file path from the config using CLI flags: # Override with relative path cdflow import --type canadahelps --file donations/emergency.csv --config /path/to/your/local.yaml # Override with absolute path cdflow import --type paypal --file /tmp/paypal_donations.csv --config /path/to/your/local.yaml Review the results: The tool will provide real-time feedback in the console. After the import is complete, you can review the results in the output directory you specified in your configuration. _success.csv : This file contains all the records that were successfully imported, along with the new NationBuilder Person ID and Donation ID. _fail.csv : This file contains any records that failed to import, along with any error message(s) in the NB Error Message column. Verify in NationBuilder: Log in to your NationBuilder account and navigate to the Finances section. You should see the newly imported donations in your transaction list. Documentation For more detailed information on configuration, usage, and troubleshooting, please see our full documentation in the repo /docs directory. Support Customers and product evaluators can reach out for support at support@caestudy.com . License This project is licensed under the Business Source License 1.1 (BSL) . Current license: BSL 1.1 with production use restrictions Converts to: Apache 2.0 License on 2029-09-01 Full terms: See the LICENSE file for complete details Contributing Contributions are welcome! Please note: All contributors must agree to our Contributor License Agreement (CLA) See Contributing Guide for details on the contribution process This is a BSL-licensed project (not open source until 2029-09-01)","title":"Home"},{"location":"#cstudy-donationflow-cli","text":"DonationFlow CLI is a command-line tool for importing donation data from external sources like CanadaHelps and PayPal into your NationBuilder account. It is designed to be a bridge for organizations that use payment processors not natively integrated with NationBuilder, or for those migrating from other CRM platforms. DonationFlow CLI is extensible to other payment processor sources through an existing adapter template and a plugin architecture through which organization-specific business rules can be implemented. DonationFlow CLI was originally developed to help a non-profit charitable organization successfully migrate their donation data from CiviCRM and integrate their existing PayPal and CanadaHelps workflows with NationBuilder.","title":"C\u00e6study DonationFlow CLI"},{"location":"#key-features","text":"Import from External Sources: Import donation data from CanadaHelps and PayPal CSV exports. Extensible Design: The tool is designed to be adaptable to other payment platform sources, includes a generic adapter, and is extensible with plugins. Detailed Logging: Comprehensive logging of every import job operation, for easy troubleshooting. Auditing: Job files provide detailed audit trail for each imported donation record. Rollback Capable: A separate command allows you to safely rollback donation import jobs (deleting the imported transaction(s) from NationBuilder) if needed.","title":"Key Features"},{"location":"#prerequisites","text":"Python 3.8+ A NationBuilder account with API access. A configured NationBuilder OAuth application. Donation data exported as CSV files from CanadaHelps or PayPal.","title":"Prerequisites"},{"location":"#installation","text":"Create an environment and activate python3 -m venv <my-environment-name> source <my-environment-name>/bin/activate Install using PIP pip install cdflow-cli For development installation, please see the Contribution Guide .","title":"Installation"},{"location":"#quick-start","text":"Initialize configuration: Run cdflow init to create template files: ~/.config/cdflow/local.yaml - Main configuration file (default location) ~/.env/nb_local.env - OAuth environment variables template (non-configurable location) Configure OAuth credentials: Edit ~/.env/nb_local.env with your NationBuilder OAuth credentials, then load:","title":"Quick Start"},{"location":"#locate-the-load-secretssh-script","text":"If you have installed via pip and have created your virtual environment: cd <path-to-venv-environment-directory>/lib/python3.13/site-packages/cdflow_cli/scripts/","title":"Locate the load-secrets.sh script"},{"location":"#execute-the-script-using-your-env-file-as-the-parameter","text":"source ./load-secrets.sh ~/.env/nb_local.env Update the import configuration: In your configuration file (e.g., local.yaml ), update the cli_import section to point to your CSV file(s). Place your CSV file: Put your CanadaHelps or PayPal CSV file in the cli_source directory you specified in your configuration. Run the import: cdflow import --config /path/to/your/local.yaml Or with less verbose output cdflow import --config /path/to/your/local.yaml --log-level NOTICE Alternative: Override import settings via CLI flags You can override the import type and file path from the config using CLI flags: # Override with relative path cdflow import --type canadahelps --file donations/emergency.csv --config /path/to/your/local.yaml # Override with absolute path cdflow import --type paypal --file /tmp/paypal_donations.csv --config /path/to/your/local.yaml Review the results: The tool will provide real-time feedback in the console. After the import is complete, you can review the results in the output directory you specified in your configuration. _success.csv : This file contains all the records that were successfully imported, along with the new NationBuilder Person ID and Donation ID. _fail.csv : This file contains any records that failed to import, along with any error message(s) in the NB Error Message column. Verify in NationBuilder: Log in to your NationBuilder account and navigate to the Finances section. You should see the newly imported donations in your transaction list.","title":"Execute the script using your .env file as the parameter"},{"location":"#documentation","text":"For more detailed information on configuration, usage, and troubleshooting, please see our full documentation in the repo /docs directory.","title":"Documentation"},{"location":"#support","text":"Customers and product evaluators can reach out for support at support@caestudy.com .","title":"Support"},{"location":"#license","text":"This project is licensed under the Business Source License 1.1 (BSL) . Current license: BSL 1.1 with production use restrictions Converts to: Apache 2.0 License on 2029-09-01 Full terms: See the LICENSE file for complete details","title":"License"},{"location":"#contributing","text":"Contributions are welcome! Please note: All contributors must agree to our Contributor License Agreement (CLA) See Contributing Guide for details on the contribution process This is a BSL-licensed project (not open source until 2029-09-01)","title":"Contributing"},{"location":"cla/","text":"Contributor License Agreement (CLA) Thank you for your interest in contributing to DonationFlow CLI . To maintain clear copyright ownership and enable the planned license transition from BSL to MIT, you must agree to the terms below before we can accept your contribution. 1. Grant of Rights You hereby grant the project owner a perpetual, worldwide, non-exclusive, royalty-free, transferable license to: - Use, reproduce, modify, adapt, publish, and distribute your contribution - Sublicense your contribution as part of this project - Include your contribution when the project converts from BSL 1.1 to Apache 2.0 License on 2029-09-01 This grant allows the project to operate under its current BSL 1.1 license and transition to Apache 2.0 as scheduled. 2. Ownership and Originality You confirm that: - You are the original author of your contribution, or you have obtained all necessary rights to submit it - Your contribution is your original work and does not infringe on any third party's intellectual property rights - You have the right to grant the license described in Section 1 You retain full copyright in your contribution. This agreement only grants the project owner the rights necessary to include your work in the project. 3. License Context You acknowledge that: - This project is currently licensed under Business Source License 1.1 (BSL) - BSL is not an open-source license and restricts production use until the Change Date - Your contribution will be subject to BSL 1.1 terms until 2029-09-01 , when the entire project converts to Apache 2.0 License - After conversion, your contribution will be available under Apache 2.0 License terms 4. Warranties and Disclaimers You represent that: - Your contribution is provided \"as-is\" without warranties of any kind - You are not obligated to provide support or maintenance for your contribution - The project owner may modify or remove your contribution at any time 5. Patent Grant If your contribution includes any patents you own or control, you grant the project owner and all users a perpetual, worldwide, non-exclusive, royalty-free patent license to make, use, sell, and distribute your contribution as part of this project. 6. Agreement By submitting a pull request to this repository, you agree to these terms. No physical signature is required. Your GitHub account and PR submission serve as your binding electronic acceptance of this agreement. Project: DonationFlow CLI Owner: Mark Emila Effective: Upon PR submission CLA Version: 1.0 (2025-10-22)","title":"CLA"},{"location":"cla/#contributor-license-agreement-cla","text":"Thank you for your interest in contributing to DonationFlow CLI . To maintain clear copyright ownership and enable the planned license transition from BSL to MIT, you must agree to the terms below before we can accept your contribution.","title":"Contributor License Agreement (CLA)"},{"location":"cla/#1-grant-of-rights","text":"You hereby grant the project owner a perpetual, worldwide, non-exclusive, royalty-free, transferable license to: - Use, reproduce, modify, adapt, publish, and distribute your contribution - Sublicense your contribution as part of this project - Include your contribution when the project converts from BSL 1.1 to Apache 2.0 License on 2029-09-01 This grant allows the project to operate under its current BSL 1.1 license and transition to Apache 2.0 as scheduled.","title":"1. Grant of Rights"},{"location":"cla/#2-ownership-and-originality","text":"You confirm that: - You are the original author of your contribution, or you have obtained all necessary rights to submit it - Your contribution is your original work and does not infringe on any third party's intellectual property rights - You have the right to grant the license described in Section 1 You retain full copyright in your contribution. This agreement only grants the project owner the rights necessary to include your work in the project.","title":"2. Ownership and Originality"},{"location":"cla/#3-license-context","text":"You acknowledge that: - This project is currently licensed under Business Source License 1.1 (BSL) - BSL is not an open-source license and restricts production use until the Change Date - Your contribution will be subject to BSL 1.1 terms until 2029-09-01 , when the entire project converts to Apache 2.0 License - After conversion, your contribution will be available under Apache 2.0 License terms","title":"3. License Context"},{"location":"cla/#4-warranties-and-disclaimers","text":"You represent that: - Your contribution is provided \"as-is\" without warranties of any kind - You are not obligated to provide support or maintenance for your contribution - The project owner may modify or remove your contribution at any time","title":"4. Warranties and Disclaimers"},{"location":"cla/#5-patent-grant","text":"If your contribution includes any patents you own or control, you grant the project owner and all users a perpetual, worldwide, non-exclusive, royalty-free patent license to make, use, sell, and distribute your contribution as part of this project.","title":"5. Patent Grant"},{"location":"cla/#6-agreement","text":"By submitting a pull request to this repository, you agree to these terms. No physical signature is required. Your GitHub account and PR submission serve as your binding electronic acceptance of this agreement. Project: DonationFlow CLI Owner: Mark Emila Effective: Upon PR submission CLA Version: 1.0 (2025-10-22)","title":"6. Agreement"},{"location":"configuration/","text":"Configuration DonationFlow CLI is configured using a YAML configuration file and environment variables for OAuth credentials. The configuration file contains application settings while OAuth credentials are provided via environment variables for security. Generating Configuration Templates The cdflow init command generates configuration templates that you can customize for your deployment. See the Usage Guide for detailed instructions. cdflow init # Creates templates in ~/.config/cdflow/ and ~/.env/ This creates: - ~/.config/cdflow/local.yaml - Main application configuration file - ~/.env/nb_local.env - OAuth environment variables template - ~/.config/cdflow/plugins/ - Plugin examples for customization Application Configuration File (e.g., local.yaml ) This is the main application configuration file. It contains settings for storage, logging, and the import process itself. Below is a breakdown of the sections relevant to the CLI tool. storage This section defines the paths for various files used by the application. You will need to customize these paths for your system. storage : paths : jobs : \"/path/to/your/jobs\" logs : \"/path/to/your/logs\" output : \"/path/to/your/output\" cli_source : \"/path/to/your/import_source\" jobs : The directory where the application will store JSON job files. These files contain a summary of each import run and are useful for auditing. logs : The directory where the application will store detailed log files. A new log file is created for each import run. output : The directory where the application will write the _success.csv and _fail.csv files of the records that have been successfully imported or have failed import cli_source : The directory where the application will look for your CSV files to be imported, if not specified on the command line. cli_import This section configures the specifics of the default CLI import run, when no file and type are specified on the command line cli_import : type : canadahelps file : ch/import.csv type : The source of the import. Use canadahelps or paypal . file : The path to the CSV file to be imported, relative to the cli_source directory. Automatic Job Tracking Fields DonationFlow CLI automatically detects and populates job tracking fields of donation records when they exist in your NationBuilder nation: import_job_id : Unique identifier for the import job that imported the donation record import_job_source : JSON metadata including context, hostname, IP, and version info to audit and track down what machine ran the job that imported the donation record These fields are automatically detected via API call during import initialization. If the fields exist in your nation's donation schema, they will be populated. If they don't exist, they are silently omitted - no manual configuration required. To add these fields to your NationBuilder nation: 1. Go to Settings > Nation > Custom fields in your NationBuilder admin 2. Add custom fields to the Donations section: - Field name: import_job_id , Type: Text - Field name: import_job_source , Type: Text area plugins This section configures the plugin system for customizing donation data processing: plugins : canadahelps : enabled : true dir : \"~/.config/cdflow/plugins/canadahelps\" paypal : enabled : true dir : \"~/.config/cdflow/plugins/paypal\" enabled : Set to true to load and execute plugins for this adapter dir : Directory containing plugin files (supports ~ for home directory) Plugins allow you to customize data transformations, tracking code mapping, payment type normalization, and eligibility filtering without modifying core code. See the Plugin Examples for more information. Other Sections The deployment , api , frontend , and logos sections are used by a (future) browser-based version of this application and can be ignored for CLI usage. OAuth Configuration (Environment Variables) OAuth credentials are provided to DonationFlow CLI via environment variables for security. The cdflow init command creates a reference template at ~/.env/nb_local.env : Edit the OAuth template After running cdflow init , edit ~/.env/nb_local.env with your NationBuilder credentials: NB_CLIENT_ID = your_actual_client_id NB_CLIENT_SECRET = your_actual_client_secret NB_SLUG = your_nation_slug NB_CONFIG_NAME = development Load OAuth credentials into environment Use the included load-secrets.sh script to source your credentials: # Find the script location python3 -c \"import cdflow_cli; from pathlib import Path; print(Path(cdflow_cli.__file__).parent / 'scripts' / 'load-secrets.sh')\" # Source the credentials (use the path from above) source /path/to/load-secrets.sh ~/.env/nb_local.env Alternatively, manually export the environment variables: export NB_CLIENT_ID = your_actual_client_id export NB_CLIENT_SECRET = your_actual_client_secret export NB_SLUG = your_nation_slug export NB_CONFIG_NAME = development About .env files The .env files are provided as reference and templates for the environment variables that are required for cdflow to authenticate and connect to your nation instance on NationBuilder. In a development scenario an .env file can be used to quickly and easily \" source \" the set of environment variables for a specific environment. Multiple .env files can be created, one for each unique environment, and can facilitate the easy switching between the multiple environments. In a production environment, as a security and privacy best practice, it is best to NOT store these secrets in plain text files and to instead use your system's secrets management and procedures to create the environment variables in the session(s) in which cdflow is needed.","title":"Configuration"},{"location":"configuration/#configuration","text":"DonationFlow CLI is configured using a YAML configuration file and environment variables for OAuth credentials. The configuration file contains application settings while OAuth credentials are provided via environment variables for security.","title":"Configuration"},{"location":"configuration/#generating-configuration-templates","text":"The cdflow init command generates configuration templates that you can customize for your deployment. See the Usage Guide for detailed instructions. cdflow init # Creates templates in ~/.config/cdflow/ and ~/.env/ This creates: - ~/.config/cdflow/local.yaml - Main application configuration file - ~/.env/nb_local.env - OAuth environment variables template - ~/.config/cdflow/plugins/ - Plugin examples for customization","title":"Generating Configuration Templates"},{"location":"configuration/#application-configuration-file-eg-localyaml","text":"This is the main application configuration file. It contains settings for storage, logging, and the import process itself. Below is a breakdown of the sections relevant to the CLI tool.","title":"Application Configuration File (e.g., local.yaml)"},{"location":"configuration/#storage","text":"This section defines the paths for various files used by the application. You will need to customize these paths for your system. storage : paths : jobs : \"/path/to/your/jobs\" logs : \"/path/to/your/logs\" output : \"/path/to/your/output\" cli_source : \"/path/to/your/import_source\" jobs : The directory where the application will store JSON job files. These files contain a summary of each import run and are useful for auditing. logs : The directory where the application will store detailed log files. A new log file is created for each import run. output : The directory where the application will write the _success.csv and _fail.csv files of the records that have been successfully imported or have failed import cli_source : The directory where the application will look for your CSV files to be imported, if not specified on the command line.","title":"storage"},{"location":"configuration/#cli_import","text":"This section configures the specifics of the default CLI import run, when no file and type are specified on the command line cli_import : type : canadahelps file : ch/import.csv type : The source of the import. Use canadahelps or paypal . file : The path to the CSV file to be imported, relative to the cli_source directory.","title":"cli_import"},{"location":"configuration/#automatic-job-tracking-fields","text":"DonationFlow CLI automatically detects and populates job tracking fields of donation records when they exist in your NationBuilder nation: import_job_id : Unique identifier for the import job that imported the donation record import_job_source : JSON metadata including context, hostname, IP, and version info to audit and track down what machine ran the job that imported the donation record These fields are automatically detected via API call during import initialization. If the fields exist in your nation's donation schema, they will be populated. If they don't exist, they are silently omitted - no manual configuration required. To add these fields to your NationBuilder nation: 1. Go to Settings > Nation > Custom fields in your NationBuilder admin 2. Add custom fields to the Donations section: - Field name: import_job_id , Type: Text - Field name: import_job_source , Type: Text area","title":"Automatic Job Tracking Fields"},{"location":"configuration/#plugins","text":"This section configures the plugin system for customizing donation data processing: plugins : canadahelps : enabled : true dir : \"~/.config/cdflow/plugins/canadahelps\" paypal : enabled : true dir : \"~/.config/cdflow/plugins/paypal\" enabled : Set to true to load and execute plugins for this adapter dir : Directory containing plugin files (supports ~ for home directory) Plugins allow you to customize data transformations, tracking code mapping, payment type normalization, and eligibility filtering without modifying core code. See the Plugin Examples for more information.","title":"plugins"},{"location":"configuration/#other-sections","text":"The deployment , api , frontend , and logos sections are used by a (future) browser-based version of this application and can be ignored for CLI usage.","title":"Other Sections"},{"location":"configuration/#oauth-configuration-environment-variables","text":"OAuth credentials are provided to DonationFlow CLI via environment variables for security. The cdflow init command creates a reference template at ~/.env/nb_local.env :","title":"OAuth Configuration (Environment Variables)"},{"location":"configuration/#edit-the-oauth-template","text":"After running cdflow init , edit ~/.env/nb_local.env with your NationBuilder credentials: NB_CLIENT_ID = your_actual_client_id NB_CLIENT_SECRET = your_actual_client_secret NB_SLUG = your_nation_slug NB_CONFIG_NAME = development","title":"Edit the OAuth template"},{"location":"configuration/#load-oauth-credentials-into-environment","text":"Use the included load-secrets.sh script to source your credentials: # Find the script location python3 -c \"import cdflow_cli; from pathlib import Path; print(Path(cdflow_cli.__file__).parent / 'scripts' / 'load-secrets.sh')\" # Source the credentials (use the path from above) source /path/to/load-secrets.sh ~/.env/nb_local.env Alternatively, manually export the environment variables: export NB_CLIENT_ID = your_actual_client_id export NB_CLIENT_SECRET = your_actual_client_secret export NB_SLUG = your_nation_slug export NB_CONFIG_NAME = development","title":"Load OAuth credentials into environment"},{"location":"configuration/#about-env-files","text":"The .env files are provided as reference and templates for the environment variables that are required for cdflow to authenticate and connect to your nation instance on NationBuilder. In a development scenario an .env file can be used to quickly and easily \" source \" the set of environment variables for a specific environment. Multiple .env files can be created, one for each unique environment, and can facilitate the easy switching between the multiple environments. In a production environment, as a security and privacy best practice, it is best to NOT store these secrets in plain text files and to instead use your system's secrets management and procedures to create the environment variables in the session(s) in which cdflow is needed.","title":"About .env files"},{"location":"contributing/","text":"Contributing to DonationFlow CLI Thank you for your interest in contributing! License and Contribution Terms This repository is licensed under the Business Source License 1.1 (BSL) , which converts to the Apache 2.0 License on 2029-09-01 . Contributor License Agreement (CLA) All contributors must agree to our Contributor License Agreement before we can merge your pull request. By submitting a pull request, you automatically agree to the CLA terms. Key points: \u2705 You retain copyright in your contribution \u2705 You grant the project owner rights to use your contribution under BSL 1.1 \u2705 Your contribution will convert to Apache 2.0 License on 2029-09-01 along with the rest of the codebase \u2705 No separate signature required\u2014your PR submission is your agreement Please review the full CLA before submitting your first contribution. Types of Contributions We Welcome Encouraged \u2705 Bug reports with clear reproduction steps Bug fixes for documented issues Documentation improvements and clarifications Test coverage improvements Plugin examples demonstrating custom business rules Feature suggestions via GitHub Issues (discuss before implementing) Requires Prior Discussion \ud83d\udcac Major features or architectural changes New dependencies or integrations Breaking changes to existing APIs Not Accepted \u274c Contributions that introduce legal uncertainty Code copied from other projects without clear licensing Changes that conflict with the project's core design principles How to Contribute Open an issue first for any non-trivial changes Fork the repository and create a feature branch Follow existing code style and conventions Add tests for new functionality Update documentation as needed Submit a pull request with a clear description Pull Request Guidelines Use a descriptive branch name (e.g., feature/add-stripe-integration , bugfix/fix-paypal-date-parsing ) Provide a clear and concise description of your changes Reference any related issues Ensure all tests pass before submitting Development Setup To set up the project for development: Clone the repository: git clone https://github.com/mkiiim/cdflow-cli.git cd cdflow-cli Create a virtual environment: python -m venv venv source venv/bin/activate # On Windows: venv\\Scripts\\activate Install the package and dependencies in editable mode: pip install -e . [ dev ] The [dev] extra will install development dependencies including pytest , black , and flake8 . Run the tests: pytest Code Style Please follow the existing code style and conventions used in the project: Formatting: Use black for code formatting Linting: Use flake8 for linting Line length: 100 characters maximum Type hints: Encouraged for new code Docstrings: Required for public functions and classes Run these tools locally before submitting: black . flake8 . Code Review Process All PRs will be reviewed for technical merit and license compliance We may request changes or clarifications We reserve the right to decline PRs that don't align with project goals Accepted contributions will be merged with attribution Questions? Open an issue or contact the maintainers before starting significant work. Note : Because this is a BSL-licensed project (not open source until 2029-09-01), we maintain tighter control over contributions than typical MIT/Apache projects. This protects both contributors and the project's commercial viability.","title":"Contributing"},{"location":"contributing/#contributing-to-donationflow-cli","text":"Thank you for your interest in contributing!","title":"Contributing to DonationFlow CLI"},{"location":"contributing/#license-and-contribution-terms","text":"This repository is licensed under the Business Source License 1.1 (BSL) , which converts to the Apache 2.0 License on 2029-09-01 .","title":"License and Contribution Terms"},{"location":"contributing/#contributor-license-agreement-cla","text":"All contributors must agree to our Contributor License Agreement before we can merge your pull request. By submitting a pull request, you automatically agree to the CLA terms. Key points: \u2705 You retain copyright in your contribution \u2705 You grant the project owner rights to use your contribution under BSL 1.1 \u2705 Your contribution will convert to Apache 2.0 License on 2029-09-01 along with the rest of the codebase \u2705 No separate signature required\u2014your PR submission is your agreement Please review the full CLA before submitting your first contribution.","title":"Contributor License Agreement (CLA)"},{"location":"contributing/#types-of-contributions-we-welcome","text":"","title":"Types of Contributions We Welcome"},{"location":"contributing/#encouraged","text":"Bug reports with clear reproduction steps Bug fixes for documented issues Documentation improvements and clarifications Test coverage improvements Plugin examples demonstrating custom business rules Feature suggestions via GitHub Issues (discuss before implementing)","title":"Encouraged \u2705"},{"location":"contributing/#requires-prior-discussion","text":"Major features or architectural changes New dependencies or integrations Breaking changes to existing APIs","title":"Requires Prior Discussion \ud83d\udcac"},{"location":"contributing/#not-accepted","text":"Contributions that introduce legal uncertainty Code copied from other projects without clear licensing Changes that conflict with the project's core design principles","title":"Not Accepted \u274c"},{"location":"contributing/#how-to-contribute","text":"Open an issue first for any non-trivial changes Fork the repository and create a feature branch Follow existing code style and conventions Add tests for new functionality Update documentation as needed Submit a pull request with a clear description","title":"How to Contribute"},{"location":"contributing/#pull-request-guidelines","text":"Use a descriptive branch name (e.g., feature/add-stripe-integration , bugfix/fix-paypal-date-parsing ) Provide a clear and concise description of your changes Reference any related issues Ensure all tests pass before submitting","title":"Pull Request Guidelines"},{"location":"contributing/#development-setup","text":"To set up the project for development: Clone the repository: git clone https://github.com/mkiiim/cdflow-cli.git cd cdflow-cli Create a virtual environment: python -m venv venv source venv/bin/activate # On Windows: venv\\Scripts\\activate Install the package and dependencies in editable mode: pip install -e . [ dev ] The [dev] extra will install development dependencies including pytest , black , and flake8 . Run the tests: pytest","title":"Development Setup"},{"location":"contributing/#code-style","text":"Please follow the existing code style and conventions used in the project: Formatting: Use black for code formatting Linting: Use flake8 for linting Line length: 100 characters maximum Type hints: Encouraged for new code Docstrings: Required for public functions and classes Run these tools locally before submitting: black . flake8 .","title":"Code Style"},{"location":"contributing/#code-review-process","text":"All PRs will be reviewed for technical merit and license compliance We may request changes or clarifications We reserve the right to decline PRs that don't align with project goals Accepted contributions will be merged with attribution","title":"Code Review Process"},{"location":"contributing/#questions","text":"Open an issue or contact the maintainers before starting significant work. Note : Because this is a BSL-licensed project (not open source until 2029-09-01), we maintain tighter control over contributions than typical MIT/Apache projects. This protects both contributors and the project's commercial viability.","title":"Questions?"},{"location":"data_formats/","text":"Data Formats This document outlines the expected CSV data formats for CanadaHelps and PayPal imports. General Recommendations It is highly recommended to use the default CSV export files provided by CanadaHelps and PayPal to ensure compatibility with the importer. The tool is designed to work with the specific column headers and data formats from these exports. CanadaHelps Export URL: https://www.canadahelps.org/en/Admin/MCDonations_DataDownload.aspx PayPal Export URL: https://www.paypal.com/reports/dlog CanadaHelps The following fields are required for a successful CanadaHelps import: DONOR FIRST NAME DONOR LAST NAME DONOR EMAIL ADDRESS AMOUNT DONATION DATE DONATION TIME TRANSACTION NUMBER PayPal The following fields are required for a successful PayPal import: Name From Email Address Gross Date Time Transaction ID Note: For PayPal imports, either the Name or From Email Address field must contain a value.","title":"Data Formats"},{"location":"data_formats/#data-formats","text":"This document outlines the expected CSV data formats for CanadaHelps and PayPal imports.","title":"Data Formats"},{"location":"data_formats/#general-recommendations","text":"It is highly recommended to use the default CSV export files provided by CanadaHelps and PayPal to ensure compatibility with the importer. The tool is designed to work with the specific column headers and data formats from these exports. CanadaHelps Export URL: https://www.canadahelps.org/en/Admin/MCDonations_DataDownload.aspx PayPal Export URL: https://www.paypal.com/reports/dlog","title":"General Recommendations"},{"location":"data_formats/#canadahelps","text":"The following fields are required for a successful CanadaHelps import: DONOR FIRST NAME DONOR LAST NAME DONOR EMAIL ADDRESS AMOUNT DONATION DATE DONATION TIME TRANSACTION NUMBER","title":"CanadaHelps"},{"location":"data_formats/#paypal","text":"The following fields are required for a successful PayPal import: Name From Email Address Gross Date Time Transaction ID Note: For PayPal imports, either the Name or From Email Address field must contain a value.","title":"PayPal"},{"location":"license/","text":"Copyright \u00a9 2025 Mark Emila (Caestudy) \u2014 https://caestudy.com All Rights Reserved. Licensed under the Business Source License (BSL) version 1.1. You may copy, modify, create derivative works, and redistribute this software for non-production use only , including development, testing, academic, and internal evaluation purposes. Change Date: 2029-09-01 Change License: Apache\u20112.0 Effective on the Change Date \u2014 or four years after first public release of a specific version, whichever comes first \u2014 this version will be relicensed under Apache\u20112.0, and the initial usage restrictions will no longer apply. THE SOFTWARE IS PROVIDED \u201cAS IS\u201d, WITHOUT WARRANTY OF ANY KIND. Use in violation of this license automatically terminates granted rights. For commercial licensing inquiries, contact licensing@caestudy.com.","title":"License"},{"location":"troubleshooting/","text":"Troubleshooting This guide provides advice on how to troubleshoot common issues with the donation import process. General Approach The application provides several layers of feedback to help you diagnose problems. The recommended approach to troubleshooting is to follow these steps in order: Check the Console Output: The application provides real-time feedback in the console as it runs. If a critical error occurs, it will often be displayed here first. This is the best place to look for immediate information about what might be going wrong. Examine the Fail File: If the import completes but some records have failed, look for the _fail.csv file in the output directory you specified in your configuration. This file will contain the exact rows that failed to import, along with a specific error message in the NB Error Message column. This can help you identify issues with specific data in your source file. Review the Log File: For the most detailed information about an import job, you should inspect the log file. A new log file is created for each job and is located in the logs directory. The log contains a timestamped record of every step in the import process, from configuration and API initialization to the processing of each individual row. Search for \"ERROR\" or \"FAILED\" to quickly find the relevant entries. Tip: If console output is too verbose, you can run with --log-level ERROR to see only error messages, or --log-level NOTICE to see important milestones without detailed processing information. Inspect the Job File: The JSON job file, located in the jobs directory, provides a high-level summary of the import. It contains the overall status of the job, the final counts of successful and failed records, and the names of the log, success, and fail files. This can be a useful starting point to get an overview of a specific import run and to find the names of the associated files. Common Issues Configuration Errors: If the application fails to start, double-check your configuration file (e.g., local.yaml ) for any syntax errors or incorrect paths. Authentication Errors: If you see errors related to OAuth or authentication, ensure that your NB_CLIENT_ID , NB_CLIENT_SECRET , and NB_SLUG environment variables are correct and that your NationBuilder user has the necessary permissions. File Not Found Errors: If the application reports that it cannot find your CSV file, make sure that the file path in your cli_import configuration is correct and that the file exists in the specified cli_source directory. Data Format Errors: If you are seeing a large number of failures in your import, it's likely that your CSV file does not match the expected format. Please refer to the Data Formats guide for the list of required fields.","title":"Troubleshooting"},{"location":"troubleshooting/#troubleshooting","text":"This guide provides advice on how to troubleshoot common issues with the donation import process.","title":"Troubleshooting"},{"location":"troubleshooting/#general-approach","text":"The application provides several layers of feedback to help you diagnose problems. The recommended approach to troubleshooting is to follow these steps in order: Check the Console Output: The application provides real-time feedback in the console as it runs. If a critical error occurs, it will often be displayed here first. This is the best place to look for immediate information about what might be going wrong. Examine the Fail File: If the import completes but some records have failed, look for the _fail.csv file in the output directory you specified in your configuration. This file will contain the exact rows that failed to import, along with a specific error message in the NB Error Message column. This can help you identify issues with specific data in your source file. Review the Log File: For the most detailed information about an import job, you should inspect the log file. A new log file is created for each job and is located in the logs directory. The log contains a timestamped record of every step in the import process, from configuration and API initialization to the processing of each individual row. Search for \"ERROR\" or \"FAILED\" to quickly find the relevant entries. Tip: If console output is too verbose, you can run with --log-level ERROR to see only error messages, or --log-level NOTICE to see important milestones without detailed processing information. Inspect the Job File: The JSON job file, located in the jobs directory, provides a high-level summary of the import. It contains the overall status of the job, the final counts of successful and failed records, and the names of the log, success, and fail files. This can be a useful starting point to get an overview of a specific import run and to find the names of the associated files.","title":"General Approach"},{"location":"troubleshooting/#common-issues","text":"Configuration Errors: If the application fails to start, double-check your configuration file (e.g., local.yaml ) for any syntax errors or incorrect paths. Authentication Errors: If you see errors related to OAuth or authentication, ensure that your NB_CLIENT_ID , NB_CLIENT_SECRET , and NB_SLUG environment variables are correct and that your NationBuilder user has the necessary permissions. File Not Found Errors: If the application reports that it cannot find your CSV file, make sure that the file path in your cli_import configuration is correct and that the file exists in the specified cli_source directory. Data Format Errors: If you are seeing a large number of failures in your import, it's likely that your CSV file does not match the expected format. Please refer to the Data Formats guide for the list of required fields.","title":"Common Issues"},{"location":"usage/","text":"Usage This guide provides detailed instructions for using the cdflow init , cdflow import and cdflow rollback commands. Setting Up Configuration ( cdflow init ) Before using cdflow , you need to set up configuration files and set environment variables. The cdflow init command creates a template configuration .yaml file that you can customize and oauth .env files as a check list of environment variables required for authentication to NationBuilder. The default location for configuration .yaml files is ~/.config/cdflow/ . The location of config files is configurable. The default location for oauth .env files is ~/.env/ . The location of environment files is NOT configurable. About .env files A .env file is provided as a reference and template for the environment variables required for cdflow to authenticate and connect to your nation instance on NationBuilder. In a development scenario a .env file can be used to quickly and easily \" source \" the set of environment variables for a specific environment. Multiple .env files can be created, one for each unique environment, and can facilitate the easy switching between the multiple environments. In a production environment, as a security and privacy best practice, it is best to not store these secrets in plain text files and to instead use your system's secrets management and procedures to create the environment variables in the session(s) in which cdflow is needed. Basic Usage cdflow init # creates config templates in default location (~/.config/cdflow/) # creates oauth .env files in non-configurable location (~/.env/) cdflow init --config-dir /path/to/config # creates config templates in the specified location (/path/to/config) # creates oauth .env files in non-configurable locaiton (~/.env/) This creates: - ~/.config/cdflow/local.yaml - Main application configuration file (default location) - ~/.env/nb_local.env - OAuth environment variables template (non-configurable location) Options --config-dir : Directory to specify the location to write configuration template file (default: ~/.config/cdflow/ ) --force : Overwrite existing files with templates without prompting File Conflict Handling If configuration and/or oauth files with the same filename(s) already exist, cdflow init will prompt you to choose: - Overwrite : Replace existing files with fresh templates - Skip : Create only missing files, keep existing ones unchanged - Cancel : Exit without making changes Use --force to automatically overwrite without prompting. Setting Up OAuth Credentials After running cdflow init , you need to configure your NationBuilder OAuth credentials: Edit the OAuth template: nano ~/.env/nb_local.env Add your credentials: NB_CLIENT_ID = your_actual_client_id NB_CLIENT_SECRET = your_actual_client_secret NB_SLUG = your_nation_slug NB_CONFIG_NAME = name_for_this_configuration_eg_develoment Source the environment using the provided load-secrets.sh shell script: Locate the load-secrets.sh script If you are in the source repo: cd ./scripts/ If you have installed via pip and have created your virtual environment: cd <path-to-venv-environment-directory>/lib/python3.13/site-packages/cdflow_cli/scripts/ Execute the script using your .env file as the parameter ./load-secrets.sh ~/.env/nb_local.env Importing Donations ( cdflow import ) This is the main command for importing donations into NationBuilder. Workflow Prepare your CSV file: Download your donation transaction report from CanadaHelps or PayPal. Ensure that the file is in the correct format (see Data Formats for details). Place the CSV file: Move your CSV file into the appropriate subdirectory within the cli_source directory you defined in your configuration file. You can further organize your imports use ch for CanadaHelps files and pp for PayPal subdirectories to organize your imports by source system. Configure the import: Open your configuration file (e.g., local.yaml ) and update the cli_import section to specify the type (either canadahelps or paypal ) and the file path (relative to cli_source ). cli_import : type : canadahelps file : ch/your_donation_file.csv Run the import command: Open your terminal and run the following command, replacing the path to your configuration file: cdflow import --config /path/to/your/local.yaml Alternative: Override import settings via CLI flags: You can override the import type and file path from the config using CLI flags: # Override with relative path cdflow import --type canadahelps --file donations/emergency.csv --config /path/to/your/local.yaml # Override with absolute path cdflow import --type paypal --file /tmp/paypal_donations.csv --config /path/to/your/local.yaml Important: When using CLI flags, both --type and --file must be used together. The configuration file is still required for OAuth settings, storage paths, and other configurations. Log Level Control Control the verbosity of console output with the --log-level option: # Show only errors cdflow import --config local.yaml --log-level ERROR # Show important milestones and errors cdflow import --config local.yaml --log-level NOTICE # Show all information (default, recommended) cdflow import --config local.yaml --log-level INFO # Show everything including debug details cdflow import --config local.yaml --log-level DEBUG Log Levels: - ERROR : Only show errors and failures - NOTICE : Show important milestones, confirmations, and errors - INFO : Show detailed progress and all of the levels above (default, recommended) - DEBUG : Show all diagnostic information and all of the levels above The default INFO level provides the right balance of detail for most users. Monitor the progress: The application will print real-time progress updates to the console. You will see information about each record being processed. Review the results: After the import is complete, you can review the results in the output directory you specified in your configuration. _success.csv : This file contains all the records that were successfully imported, along with the new NationBuilder Person ID and Donation ID. _fail.csv : This file contains any records that failed to import, along with any error message(s) in the NB Error Message column. Verify in NationBuilder: Log in to your NationBuilder account and navigate to the Finances section. You should see the newly imported donations in your transaction list. Rolling Back Donations ( cdflow rollback ) This command allows you to delete donations that were previously imported. This is useful for correcting mistakes or for testing purposes. Warning: This is a destructive operation. Please be sure you want to remove the donations from your nation before running this command. Workflow Run the rollback command: Open your terminal and run the following command, replacing the path to your configuration file: cdflow rollback --config /path/to/your/config.yaml # Or with custom log level cdflow rollback --config /path/to/your/config.yaml --log-level NOTICE Select the import to rollback: The tool will scan your output directory for _success.csv files and present them as a list of completed imports. Use arrow keys to highlight the import and press enter to select Confirm the operation: The tool will show you a summary of the rollback operation and ask for your confirmation before proceeding. Monitor the progress: The application will output real-time progress updates to the console as it removes each donation in the selected _success.csv file, in the reverse order in which they were added. Review the results: A new _rollback.csv file will be created in your output directory, containing the results of the rollback operation. Storage Configuration DonationFlow supports flexible storage configuration to accommodate different deployment scenarios. Basic Configuration (Default) By default, storage paths are resolved relative to your current working directory: storage : paths : jobs : \"storage/jobs\" # Created relative to pwd logs : \"storage/logs\" # Created relative to pwd output : \"storage/output\" # Created relative to pwd app_upload : \"storage/app_upload\" # Created relative to pwd app_processing : \"storage/app_processing\" # Created relative to pwd cli_source : \"storage/import_source\" # Created relative to pwd Centralized Storage with Base Path For server deployments or when you want all storage in a consistent location, use the base_path option: storage : base_path : \"/opt/cdflow-data\" # Base directory for all storage paths : jobs : \"jobs\" # Resolves to /opt/cdflow-data/jobs logs : \"logs\" # Resolves to /opt/cdflow-data/logs output : \"output\" # Resolves to /opt/cdflow-data/output app_upload : \"app_upload\" # Resolves to /opt/cdflow-data/app_upload app_processing : \"app_processing\" # Resolves to /opt/cdflow-data/app_processing cli_source : \"import_source\" # Resolves to /opt/cdflow-data/import_source Mixed Configuration You can combine base_path with absolute path overrides for specific directories: storage : base_path : \"/opt/cdflow-data\" # Base for relative paths paths : logs : \"logs\" # Using base_path, resolves to: /opt/cdflow-data/logs jobs : \"jobs\" # Using base_path, resolves to: /opt/cdflow-data/jobs output : \"output\" # Using base_path, resolves to: /opt/cdflow-data/output app_upload : \"app_upload\" # Using base_path, resolves to: /opt/cdflow-data/app_upload app_processing : \"app_processing\" # Using base_path, resolves to: /opt/cdflow-data/app_upload cli_source : \"/path/to/your/import_source\" # Using absolute path: /path/to/your/import_source Benefits of Base Path Server Deployments : Centralize all application data in one location Permissions : Easier to manage file permissions for a single directory tree Backups : Simple to backup entire application data directory Docker : Clean separation of application data from container filesystem Multi-User : Each user can have their own base_path in shared environments","title":"Usage Guide"},{"location":"usage/#usage","text":"This guide provides detailed instructions for using the cdflow init , cdflow import and cdflow rollback commands.","title":"Usage"},{"location":"usage/#setting-up-configuration-cdflow-init","text":"Before using cdflow , you need to set up configuration files and set environment variables. The cdflow init command creates a template configuration .yaml file that you can customize and oauth .env files as a check list of environment variables required for authentication to NationBuilder. The default location for configuration .yaml files is ~/.config/cdflow/ . The location of config files is configurable. The default location for oauth .env files is ~/.env/ . The location of environment files is NOT configurable.","title":"Setting Up Configuration (cdflow init)"},{"location":"usage/#about-env-files","text":"A .env file is provided as a reference and template for the environment variables required for cdflow to authenticate and connect to your nation instance on NationBuilder. In a development scenario a .env file can be used to quickly and easily \" source \" the set of environment variables for a specific environment. Multiple .env files can be created, one for each unique environment, and can facilitate the easy switching between the multiple environments. In a production environment, as a security and privacy best practice, it is best to not store these secrets in plain text files and to instead use your system's secrets management and procedures to create the environment variables in the session(s) in which cdflow is needed.","title":"About .env files"},{"location":"usage/#basic-usage","text":"cdflow init # creates config templates in default location (~/.config/cdflow/) # creates oauth .env files in non-configurable location (~/.env/) cdflow init --config-dir /path/to/config # creates config templates in the specified location (/path/to/config) # creates oauth .env files in non-configurable locaiton (~/.env/) This creates: - ~/.config/cdflow/local.yaml - Main application configuration file (default location) - ~/.env/nb_local.env - OAuth environment variables template (non-configurable location)","title":"Basic Usage"},{"location":"usage/#options","text":"--config-dir : Directory to specify the location to write configuration template file (default: ~/.config/cdflow/ ) --force : Overwrite existing files with templates without prompting","title":"Options"},{"location":"usage/#file-conflict-handling","text":"If configuration and/or oauth files with the same filename(s) already exist, cdflow init will prompt you to choose: - Overwrite : Replace existing files with fresh templates - Skip : Create only missing files, keep existing ones unchanged - Cancel : Exit without making changes Use --force to automatically overwrite without prompting.","title":"File Conflict Handling"},{"location":"usage/#setting-up-oauth-credentials","text":"After running cdflow init , you need to configure your NationBuilder OAuth credentials: Edit the OAuth template: nano ~/.env/nb_local.env Add your credentials: NB_CLIENT_ID = your_actual_client_id NB_CLIENT_SECRET = your_actual_client_secret NB_SLUG = your_nation_slug NB_CONFIG_NAME = name_for_this_configuration_eg_develoment Source the environment using the provided load-secrets.sh shell script:","title":"Setting Up OAuth Credentials"},{"location":"usage/#locate-the-load-secretssh-script","text":"If you are in the source repo: cd ./scripts/ If you have installed via pip and have created your virtual environment: cd <path-to-venv-environment-directory>/lib/python3.13/site-packages/cdflow_cli/scripts/","title":"Locate the load-secrets.sh script"},{"location":"usage/#execute-the-script-using-your-env-file-as-the-parameter","text":"./load-secrets.sh ~/.env/nb_local.env","title":"Execute the script using your .env file as the parameter"},{"location":"usage/#importing-donations-cdflow-import","text":"This is the main command for importing donations into NationBuilder.","title":"Importing Donations (cdflow import)"},{"location":"usage/#workflow","text":"Prepare your CSV file: Download your donation transaction report from CanadaHelps or PayPal. Ensure that the file is in the correct format (see Data Formats for details). Place the CSV file: Move your CSV file into the appropriate subdirectory within the cli_source directory you defined in your configuration file. You can further organize your imports use ch for CanadaHelps files and pp for PayPal subdirectories to organize your imports by source system. Configure the import: Open your configuration file (e.g., local.yaml ) and update the cli_import section to specify the type (either canadahelps or paypal ) and the file path (relative to cli_source ). cli_import : type : canadahelps file : ch/your_donation_file.csv Run the import command: Open your terminal and run the following command, replacing the path to your configuration file: cdflow import --config /path/to/your/local.yaml Alternative: Override import settings via CLI flags: You can override the import type and file path from the config using CLI flags: # Override with relative path cdflow import --type canadahelps --file donations/emergency.csv --config /path/to/your/local.yaml # Override with absolute path cdflow import --type paypal --file /tmp/paypal_donations.csv --config /path/to/your/local.yaml Important: When using CLI flags, both --type and --file must be used together. The configuration file is still required for OAuth settings, storage paths, and other configurations.","title":"Workflow"},{"location":"usage/#log-level-control","text":"Control the verbosity of console output with the --log-level option: # Show only errors cdflow import --config local.yaml --log-level ERROR # Show important milestones and errors cdflow import --config local.yaml --log-level NOTICE # Show all information (default, recommended) cdflow import --config local.yaml --log-level INFO # Show everything including debug details cdflow import --config local.yaml --log-level DEBUG Log Levels: - ERROR : Only show errors and failures - NOTICE : Show important milestones, confirmations, and errors - INFO : Show detailed progress and all of the levels above (default, recommended) - DEBUG : Show all diagnostic information and all of the levels above The default INFO level provides the right balance of detail for most users. Monitor the progress: The application will print real-time progress updates to the console. You will see information about each record being processed. Review the results: After the import is complete, you can review the results in the output directory you specified in your configuration. _success.csv : This file contains all the records that were successfully imported, along with the new NationBuilder Person ID and Donation ID. _fail.csv : This file contains any records that failed to import, along with any error message(s) in the NB Error Message column. Verify in NationBuilder: Log in to your NationBuilder account and navigate to the Finances section. You should see the newly imported donations in your transaction list.","title":"Log Level Control"},{"location":"usage/#rolling-back-donations-cdflow-rollback","text":"This command allows you to delete donations that were previously imported. This is useful for correcting mistakes or for testing purposes. Warning: This is a destructive operation. Please be sure you want to remove the donations from your nation before running this command.","title":"Rolling Back Donations (cdflow rollback)"},{"location":"usage/#workflow_1","text":"Run the rollback command: Open your terminal and run the following command, replacing the path to your configuration file: cdflow rollback --config /path/to/your/config.yaml # Or with custom log level cdflow rollback --config /path/to/your/config.yaml --log-level NOTICE Select the import to rollback: The tool will scan your output directory for _success.csv files and present them as a list of completed imports. Use arrow keys to highlight the import and press enter to select Confirm the operation: The tool will show you a summary of the rollback operation and ask for your confirmation before proceeding. Monitor the progress: The application will output real-time progress updates to the console as it removes each donation in the selected _success.csv file, in the reverse order in which they were added. Review the results: A new _rollback.csv file will be created in your output directory, containing the results of the rollback operation.","title":"Workflow"},{"location":"usage/#storage-configuration","text":"DonationFlow supports flexible storage configuration to accommodate different deployment scenarios.","title":"Storage Configuration"},{"location":"usage/#basic-configuration-default","text":"By default, storage paths are resolved relative to your current working directory: storage : paths : jobs : \"storage/jobs\" # Created relative to pwd logs : \"storage/logs\" # Created relative to pwd output : \"storage/output\" # Created relative to pwd app_upload : \"storage/app_upload\" # Created relative to pwd app_processing : \"storage/app_processing\" # Created relative to pwd cli_source : \"storage/import_source\" # Created relative to pwd","title":"Basic Configuration (Default)"},{"location":"usage/#centralized-storage-with-base-path","text":"For server deployments or when you want all storage in a consistent location, use the base_path option: storage : base_path : \"/opt/cdflow-data\" # Base directory for all storage paths : jobs : \"jobs\" # Resolves to /opt/cdflow-data/jobs logs : \"logs\" # Resolves to /opt/cdflow-data/logs output : \"output\" # Resolves to /opt/cdflow-data/output app_upload : \"app_upload\" # Resolves to /opt/cdflow-data/app_upload app_processing : \"app_processing\" # Resolves to /opt/cdflow-data/app_processing cli_source : \"import_source\" # Resolves to /opt/cdflow-data/import_source","title":"Centralized Storage with Base Path"},{"location":"usage/#mixed-configuration","text":"You can combine base_path with absolute path overrides for specific directories: storage : base_path : \"/opt/cdflow-data\" # Base for relative paths paths : logs : \"logs\" # Using base_path, resolves to: /opt/cdflow-data/logs jobs : \"jobs\" # Using base_path, resolves to: /opt/cdflow-data/jobs output : \"output\" # Using base_path, resolves to: /opt/cdflow-data/output app_upload : \"app_upload\" # Using base_path, resolves to: /opt/cdflow-data/app_upload app_processing : \"app_processing\" # Using base_path, resolves to: /opt/cdflow-data/app_upload cli_source : \"/path/to/your/import_source\" # Using absolute path: /path/to/your/import_source","title":"Mixed Configuration"},{"location":"usage/#benefits-of-base-path","text":"Server Deployments : Centralize all application data in one location Permissions : Easier to manage file permissions for a single directory tree Backups : Simple to backup entire application data directory Docker : Clean separation of application data from container filesystem Multi-User : Each user can have their own base_path in shared environments","title":"Benefits of Base Path"},{"location":"plugins/overview/","text":"DonationFlow CLI Plugin Examples This directory contains example plugins demonstrating the DonationFlow CLI plugin system. What are Plugins? Plugins allow you to customize donation data processing without modifying the core DonationFlow CLI code. They execute at different stages of the import process: row_transformer : Transform CSV data during mapper initialization (dictionary phase) field_processor : Process individual fields during parsing (future, not implemented) donation_validator : Validate/modify complete donation objects (future, not implemented) Execution Phases Dictionary Phase (row_transformer): - Executes during DonationMapper.__init__() before object construction completes - Works with row data as a dictionary (Python dict ) - Can read/modify dictionary entries - Can add underscore fields ( _field_name ) that mappers will consume - Cannot access mapper object properties (they don't exist yet) - This is where plugins set business logic fields via underscore convention Object Phase (field_processor, donation_validator - future): - Would execute after mapper object is fully constructed - Would work with DonationMapper object and its NBfield_name properties - Would have full access to all NationBuilder fields - Not yet implemented Installation Plugin examples are automatically copied when you run cdflow init : cdflow init This creates: - ~/.config/cdflow/plugins/canadahelps/ - CanadaHelps plugin examples - ~/.config/cdflow/plugins/paypal/ - PayPal plugin examples All plugin files start with _ prefix (disabled by default). To enable a plugin, remove the _ prefix: # Example: Enable the eligibility filter plugin cd ~/.config/cdflow/plugins/canadahelps/ mv _99_eligibility_filter.py 99_eligibility_filter.py Then configure plugins in your ~/.config/cdflow/local.yaml : plugins : canadahelps : enabled : true dir : \"~/.config/cdflow/plugins/canadahelps\" paypal : enabled : true dir : \"~/.config/cdflow/plugins/paypal\" Available Examples CanadaHelps Plugins ( cdflow_cli/examples/plugins/canadahelps/ ) 00_check_number_formatter.py Formats check numbers with \"CH_\" prefix using the transaction number field. 10_anonymous_email.py Handles anonymous donor emails. Sets custom email addresses for anonymous CanadaHelps donations. 20_tracking_code_mapper.py Maps donations to tracking codes based on MONTHLY GIFT ID field. Monthly donations get a different tracking code than one-time donations. 30_payment_type_mapper.py Maps CanadaHelps payment methods to NationBuilder payment types (e.g., \"ApplePay\" \u2192 \"Apple Pay\", \"Cheque\" \u2192 \"Check\"). 40_sanitize_anon_fields.py Replaces all \"ANON\" values with empty strings. CanadaHelps uses \"ANON\" to mark anonymous donor information. 99_eligibility_filter.py Filters ineligible donations. Sets _skip_row flag for records missing receiptable amount or missing both name and email. PayPal Plugins ( cdflow_cli/examples/plugins/paypal/ ) 00_check_number_formatter.py Formats check numbers with \"PP_\" prefix using the transaction ID field. 10_external_id_lookup.py Person lookup by external ID for PayPal transactions. 20_tracking_code_mapper.py Maps Item Title to tracking codes using substring matching (e.g., \"month\" \u2192 membership_paypal_monthly). 30_payment_type_mapper.py Maps PayPal transaction types to NationBuilder payment types. 99_eligibility_filter.py Filters ineligible donations. Sets _skip_row flag for duplicate records (Custom Number populated) or records missing both name and email. Creating Your Own Plugins Basic Template from cdflow_cli.plugins.registry import register_plugin @register_plugin ( \"canadahelps\" , \"row_transformer\" ) def my_custom_plugin ( row_data : dict ) -> dict : \"\"\" Describe what your plugin does. Args: row_data: Raw CSV row as dictionary Returns: Modified row_data \"\"\" # Your transformation logic here return row_data Plugin Types row_transformer - Transforms raw CSV row data before parsing @register_plugin ( \"canadahelps\" , \"row_transformer\" ) def my_transformer ( row_data : dict ) -> dict : # Modify row_data dictionary return row_data field_processor (coming soon) - Processes individual field values @register_plugin ( \"canadahelps\" , \"field_processor\" ) def my_processor ( field_name : str , value : any , row_data : dict ) -> any : # Modify specific field value return value donation_validator (coming soon) - Validates/modifies complete donation objects @register_plugin ( \"canadahelps\" , \"donation_validator\" ) def my_validator ( donation : DonationMapper ) -> DonationMapper : # Validate or modify donation object return donation Plugin Execution Plugins execute in alphabetical order by filename Use numeric prefixes ( 00_ , 10_ , 20_ , etc.) to control execution order Disable plugins by prefixing filename with underscore (e.g., _99_eligibility_filter.py ) Example plugins from cdflow init start disabled with _ prefix - remove _ to enable Recommended Ordering Convention 00-09 : Special operations (formatting, person lookup, etc.) 10-89 : Data transformations (tracking codes, payment types, field mapping) 90-99 : Filtering/validation (eligibility checks, _skip_row flags) Example: 00_check_number_formatter.py # Format: standardize check numbers 10_external_id_lookup.py # Lookup: person by external ID 20_tracking_code_mapper.py # Transform: set tracking code 30_payment_type_mapper.py # Transform: set payment type 40_sanitize_anon_fields.py # Transform: clean anonymous fields 99_eligibility_filter.py # Filter: skip ineligible records (LAST) Why this order? Transform data first, then filter. This is more efficient and ensures filtering decisions are based on complete, transformed data. Plugin-to-Mapper Communication API Plugins communicate with mappers through an underscore field convention . This is an intentional API contract where plugins set _field_name entries in the row dictionary, and the mapper base class consumes them to populate corresponding NBfield_name properties. Business Logic Fields These underscore fields map directly to NationBuilder donation fields: Plugin Sets Mapper Reads As Purpose _check_number NBcheck_number Formatted check/transaction number _payment_type NBpayment_type_name Payment type (e.g., \"Check\", \"Apple Pay\") _tracking_code NBtracking_code_slug Campaign tracking code Example: # Plugin sets underscore field row_data [ \"_check_number\" ] = f \"CH_ { transaction_number } \" # Base class reads it (donation.py line 77) self . NBcheck_number = data . get ( \"_check_number\" , \"\" ) Control Fields These fields control import processing behavior: _skip_row : Set to True to mark record as ineligible (skips donation creation) _skip_reason : Detailed reason for skipping (logged in fail file) Important Notes Underscore fields are intentional : Plugins explicitly know they're providing values for NationBuilder fields Fields are filtered : Underscore fields don't appear in CSV output files Execution timing : Plugins run during mapper initialization, before the mapper object is fully constructed Dictionary phase : Plugins work with the row dictionary; they cannot access mapper object properties or methods Tips Keep plugins simple - One plugin should do one thing well Handle errors gracefully - Plugin errors are logged but don't stop the import Test with small datasets first before running on production data Document your plugins - Future you will thank you Adapter Support Currently supported adapters: - canadahelps - paypal Each adapter has its own plugins directory. Need Help? Check the main documentation Review the example plugins in this directory Test plugins with a small CSV file first","title":"Overview"},{"location":"plugins/overview/#donationflow-cli-plugin-examples","text":"This directory contains example plugins demonstrating the DonationFlow CLI plugin system.","title":"DonationFlow CLI Plugin Examples"},{"location":"plugins/overview/#what-are-plugins","text":"Plugins allow you to customize donation data processing without modifying the core DonationFlow CLI code. They execute at different stages of the import process: row_transformer : Transform CSV data during mapper initialization (dictionary phase) field_processor : Process individual fields during parsing (future, not implemented) donation_validator : Validate/modify complete donation objects (future, not implemented)","title":"What are Plugins?"},{"location":"plugins/overview/#execution-phases","text":"Dictionary Phase (row_transformer): - Executes during DonationMapper.__init__() before object construction completes - Works with row data as a dictionary (Python dict ) - Can read/modify dictionary entries - Can add underscore fields ( _field_name ) that mappers will consume - Cannot access mapper object properties (they don't exist yet) - This is where plugins set business logic fields via underscore convention Object Phase (field_processor, donation_validator - future): - Would execute after mapper object is fully constructed - Would work with DonationMapper object and its NBfield_name properties - Would have full access to all NationBuilder fields - Not yet implemented","title":"Execution Phases"},{"location":"plugins/overview/#installation","text":"Plugin examples are automatically copied when you run cdflow init : cdflow init This creates: - ~/.config/cdflow/plugins/canadahelps/ - CanadaHelps plugin examples - ~/.config/cdflow/plugins/paypal/ - PayPal plugin examples All plugin files start with _ prefix (disabled by default). To enable a plugin, remove the _ prefix: # Example: Enable the eligibility filter plugin cd ~/.config/cdflow/plugins/canadahelps/ mv _99_eligibility_filter.py 99_eligibility_filter.py Then configure plugins in your ~/.config/cdflow/local.yaml : plugins : canadahelps : enabled : true dir : \"~/.config/cdflow/plugins/canadahelps\" paypal : enabled : true dir : \"~/.config/cdflow/plugins/paypal\"","title":"Installation"},{"location":"plugins/overview/#available-examples","text":"","title":"Available Examples"},{"location":"plugins/overview/#canadahelps-plugins-cdflow_cliexamplespluginscanadahelps","text":"","title":"CanadaHelps Plugins (cdflow_cli/examples/plugins/canadahelps/)"},{"location":"plugins/overview/#00_check_number_formatterpy","text":"Formats check numbers with \"CH_\" prefix using the transaction number field.","title":"00_check_number_formatter.py"},{"location":"plugins/overview/#10_anonymous_emailpy","text":"Handles anonymous donor emails. Sets custom email addresses for anonymous CanadaHelps donations.","title":"10_anonymous_email.py"},{"location":"plugins/overview/#20_tracking_code_mapperpy","text":"Maps donations to tracking codes based on MONTHLY GIFT ID field. Monthly donations get a different tracking code than one-time donations.","title":"20_tracking_code_mapper.py"},{"location":"plugins/overview/#30_payment_type_mapperpy","text":"Maps CanadaHelps payment methods to NationBuilder payment types (e.g., \"ApplePay\" \u2192 \"Apple Pay\", \"Cheque\" \u2192 \"Check\").","title":"30_payment_type_mapper.py"},{"location":"plugins/overview/#40_sanitize_anon_fieldspy","text":"Replaces all \"ANON\" values with empty strings. CanadaHelps uses \"ANON\" to mark anonymous donor information.","title":"40_sanitize_anon_fields.py"},{"location":"plugins/overview/#99_eligibility_filterpy","text":"Filters ineligible donations. Sets _skip_row flag for records missing receiptable amount or missing both name and email.","title":"99_eligibility_filter.py"},{"location":"plugins/overview/#paypal-plugins-cdflow_cliexamplespluginspaypal","text":"","title":"PayPal Plugins (cdflow_cli/examples/plugins/paypal/)"},{"location":"plugins/overview/#00_check_number_formatterpy_1","text":"Formats check numbers with \"PP_\" prefix using the transaction ID field.","title":"00_check_number_formatter.py"},{"location":"plugins/overview/#10_external_id_lookuppy","text":"Person lookup by external ID for PayPal transactions.","title":"10_external_id_lookup.py"},{"location":"plugins/overview/#20_tracking_code_mapperpy_1","text":"Maps Item Title to tracking codes using substring matching (e.g., \"month\" \u2192 membership_paypal_monthly).","title":"20_tracking_code_mapper.py"},{"location":"plugins/overview/#30_payment_type_mapperpy_1","text":"Maps PayPal transaction types to NationBuilder payment types.","title":"30_payment_type_mapper.py"},{"location":"plugins/overview/#99_eligibility_filterpy_1","text":"Filters ineligible donations. Sets _skip_row flag for duplicate records (Custom Number populated) or records missing both name and email.","title":"99_eligibility_filter.py"},{"location":"plugins/overview/#creating-your-own-plugins","text":"","title":"Creating Your Own Plugins"},{"location":"plugins/overview/#basic-template","text":"from cdflow_cli.plugins.registry import register_plugin @register_plugin ( \"canadahelps\" , \"row_transformer\" ) def my_custom_plugin ( row_data : dict ) -> dict : \"\"\" Describe what your plugin does. Args: row_data: Raw CSV row as dictionary Returns: Modified row_data \"\"\" # Your transformation logic here return row_data","title":"Basic Template"},{"location":"plugins/overview/#plugin-types","text":"row_transformer - Transforms raw CSV row data before parsing @register_plugin ( \"canadahelps\" , \"row_transformer\" ) def my_transformer ( row_data : dict ) -> dict : # Modify row_data dictionary return row_data field_processor (coming soon) - Processes individual field values @register_plugin ( \"canadahelps\" , \"field_processor\" ) def my_processor ( field_name : str , value : any , row_data : dict ) -> any : # Modify specific field value return value donation_validator (coming soon) - Validates/modifies complete donation objects @register_plugin ( \"canadahelps\" , \"donation_validator\" ) def my_validator ( donation : DonationMapper ) -> DonationMapper : # Validate or modify donation object return donation","title":"Plugin Types"},{"location":"plugins/overview/#plugin-execution","text":"Plugins execute in alphabetical order by filename Use numeric prefixes ( 00_ , 10_ , 20_ , etc.) to control execution order Disable plugins by prefixing filename with underscore (e.g., _99_eligibility_filter.py ) Example plugins from cdflow init start disabled with _ prefix - remove _ to enable","title":"Plugin Execution"},{"location":"plugins/overview/#recommended-ordering-convention","text":"00-09 : Special operations (formatting, person lookup, etc.) 10-89 : Data transformations (tracking codes, payment types, field mapping) 90-99 : Filtering/validation (eligibility checks, _skip_row flags) Example: 00_check_number_formatter.py # Format: standardize check numbers 10_external_id_lookup.py # Lookup: person by external ID 20_tracking_code_mapper.py # Transform: set tracking code 30_payment_type_mapper.py # Transform: set payment type 40_sanitize_anon_fields.py # Transform: clean anonymous fields 99_eligibility_filter.py # Filter: skip ineligible records (LAST) Why this order? Transform data first, then filter. This is more efficient and ensures filtering decisions are based on complete, transformed data.","title":"Recommended Ordering Convention"},{"location":"plugins/overview/#plugin-to-mapper-communication-api","text":"Plugins communicate with mappers through an underscore field convention . This is an intentional API contract where plugins set _field_name entries in the row dictionary, and the mapper base class consumes them to populate corresponding NBfield_name properties.","title":"Plugin-to-Mapper Communication API"},{"location":"plugins/overview/#business-logic-fields","text":"These underscore fields map directly to NationBuilder donation fields: Plugin Sets Mapper Reads As Purpose _check_number NBcheck_number Formatted check/transaction number _payment_type NBpayment_type_name Payment type (e.g., \"Check\", \"Apple Pay\") _tracking_code NBtracking_code_slug Campaign tracking code Example: # Plugin sets underscore field row_data [ \"_check_number\" ] = f \"CH_ { transaction_number } \" # Base class reads it (donation.py line 77) self . NBcheck_number = data . get ( \"_check_number\" , \"\" )","title":"Business Logic Fields"},{"location":"plugins/overview/#control-fields","text":"These fields control import processing behavior: _skip_row : Set to True to mark record as ineligible (skips donation creation) _skip_reason : Detailed reason for skipping (logged in fail file)","title":"Control Fields"},{"location":"plugins/overview/#important-notes","text":"Underscore fields are intentional : Plugins explicitly know they're providing values for NationBuilder fields Fields are filtered : Underscore fields don't appear in CSV output files Execution timing : Plugins run during mapper initialization, before the mapper object is fully constructed Dictionary phase : Plugins work with the row dictionary; they cannot access mapper object properties or methods","title":"Important Notes"},{"location":"plugins/overview/#tips","text":"Keep plugins simple - One plugin should do one thing well Handle errors gracefully - Plugin errors are logged but don't stop the import Test with small datasets first before running on production data Document your plugins - Future you will thank you","title":"Tips"},{"location":"plugins/overview/#adapter-support","text":"Currently supported adapters: - canadahelps - paypal Each adapter has its own plugins directory.","title":"Adapter Support"},{"location":"plugins/overview/#need-help","text":"Check the main documentation Review the example plugins in this directory Test plugins with a small CSV file first","title":"Need Help?"}]}